# DNS-TXID-steganography
DNS-TXID-steganography

## Project overview

This repository contains a proof-of-concept implementation and analysis of a covert communication channel built on top of DNS — specifically by embedding hidden information in the 16-bit **Transaction ID (TXID)** field of DNS queries and by using visually-similar, crafted subdomain names as cover.  
The work was created as an academic project to explore **network steganography**, measure channel capacity, and investigate detection challenges.

The system is composed of three cooperating components:

- **Sender (client)** — prepares plaintext, converts it to a binary stream, encodes fragments into TXID-sized chunks, and issues simulated DNS queries carrying that information.
- **Hidden receiver (server / authoritative DNS)** — listens for incoming DNS queries, extracts TXID and domain metadata, demixes and reassembles the binary stream, and writes recovered plaintext to disk.
- **Detector** — offline analysis tool that scans packet captures (`.pcap`) to flag sequences consistent with this covert channel.

> Test material used in experiments: a ~55 kB text file containing *Antigone* (Sofocles) supplied by the course instructor.

## High-level design

### Why TXID?
TXID is a 16-bit identifier generated by DNS clients to correlate queries and responses. It is normally treated as random and not inspected deeply by many monitoring tools, making it an attractive meta-field for encoding small amounts of data without touching DNS resource record payloads.

### Two-layer concealment
1. **Metadata channel (primary):** payload bits are encoded directly into TXID values.
2. **Name-based camouflage (auxiliary):** crafted subdomain strings (visual homographs, e.g., `rnicrosoft.com` resembling `microsoft.com`) are used to make queries look plausible in aggregate and to carry optional signaling information.

### Encoding strategy (conceptual)
- Plaintext → bytes → stream of bits.
- Bits are grouped so each DNS packet can carry a fixed number of bits (client pairs bytes into 16-bit words to map to TXID).
- A bit-mixing / permutation step is used to reduce simple pattern signatures in the raw 16-bit values.
- Transmission is delimited by reserved markers (special 16-bit values, e.g. `0x0000`) indicating start and end of transfer.
- Interspersed random “noise” queries (with random TXIDs and benign domain names) are sent before/after/around the real data to raise the signal-to-noise ratio and reduce obvious correlation.

## Component responsibilities (repository layout)

- `client.py` — Sender implementation  
  - Accepts plaintext input, splits and encodes it into TXID-sized chunks, constructs simulated DNS queries, and sends them.  
  - Generates faux "background" DNS traffic for camouflage.

- `server.py` — Hidden receiver / authoritative side  
  - Listens for incoming DNS queries, recognizes start/stop markers, collects TXID values, unmixed them, and reassembles the original message into a text file.

- `stego_pcap_analyzer.py` — Offline detection tool  
  - Parses `.pcap` captures and searches DNS packets for suspicious TXID sequences and associated crafted domains from a configurable dictionary. Reports candidate transfers.
